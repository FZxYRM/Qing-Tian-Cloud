# -*- coding: utf-8 -*-
"""
Created on Mon May 27 17:13:08 2024

@author: Fang. ZHOU; 202183820003@nuist.edu.cn
"""

# import requests  获取所有城市的id——name
# # 初始化城市字典
# city_dic = {}
# # 定义请求的URL
# url = 'https://weather.cma.cn/api/map/weather/1?t=1716456468468'
# # 发送GET请求
# response = requests.get(url)
# # 解析响应为JSON
# data = response.json()
# if data['code'] == 0:
#     city_data = data['data']['city']
#     for city in city_data:
#         city_num = city[0]
#         city_name = city[1]
#         city_dic[city_name] = city_num
#
# Import Meteostat library and dependencies
import urllib.error
import h5py
import numpy as np
import pandas as pd
from bs4 import BeautifulSoup
import random
from meteostat import Stations, Point, Daily,Hourly
import matplotlib.pyplot as plt
from datetime import datetime
import requests
import urllib.request
from PIL import Image
from io import BytesIO


def get_city_id2(city_name):
    city_id = {'桐庐': '58542', '盖州': '54474', '中沙': '59979', '沐川': '56490', '吐鲁番': '51573', '蒙城': '58118',
               '方正': '50964', '华蓥': 'S4655', '连南': '59071', '马龙': '56782', '宁明': '59427', '林西': '54115',
               '新民': '54333', '康县': '57105', '朝阳': '54324', '麻城': '57399', '石台': '58428', '兴宁': '59109',
               '泰宁': '58820', '夏津': '54803', '蔡甸': '57489', '广昌': '58813', '娄底': '57763', '烟台': '54765',
               '肇源': '50954', '新巴尔虎右旗': '50603', '栾川': '57077', '江油': '56195', '喀喇沁旗': '54313', '宁都': '58806',
               '通江': '57320', '定结': '55666', '双城': '50955', '成武': '58003', '沂南': '54935', '城步': '57857',
               '玛纳斯': '51359', '东乡': '52981', '龙海': '59127', '石棉': '56378', '洋县': '57126', '延吉': '54292',
               '剑川': '56646', '沂源': '54836', '东川': '56688', '平鲁': '53574', '民乐': '52656', '凤山': '59021',
               '望奎': '50852', '金堂': '56296', '晋城': '53976', '椒江': '58665-AZJ', '宁晋': '53796', '浑源': '53582',
               '那仁宝力格': '53083', '通道': '57845', '赤城': '54404', '金寨': '58306', '陇县': '57003', '磐安': '58560',
               '营山': '57318', '曲麻莱': '56021', '望江': '58418', '敦煌': '52418', '榆林': '53646', '永兴': '57887',
               '建昌': '54452', '腾冲': '56739', '浠水': '58404', '福清': '58942', '秀屿': '58938', '蓬安': '57317',
               '息县': '57296', '峡江': '58704', '康马': '55676', '白沙': '59848', '宾县': '50960', '建宁': '58822',
               '岳阳县': '57587', '长泰': '59122', '昌都': '56137', '蕲春': '58408', '固始': '58208', '民丰': '51839',
               '红原': '56173', '莱州': '54749', '米林': '56317', '武川': '53368', '钓鱼岛': '58981', '诸暨': '58550',
               '龙川': '59107', '驻马店': '57290', '沅江': '57671', '南乐': '54901', '北票': '54323', '文安': '54612',
               '通州': '58268', '来宾': '59242', '兴仁': '57902', '金秀': '59057', '麻江': '57828', '扎鲁特旗': '54026',
               '任丘': '54610', '同德': '52957', '洛南': '57057', '温岭': '58664', '伽师': '51707', '乌拉特后旗': '53324',
               '池州': '58427', '高要': '59278', '平乡': '54632', '齐齐哈尔': '50745', '台儿庄': '58025', '原阳': '53989',
               '汤原': '50871', '荥经': '56373', '沅陵县': '57655', '涉县': '53886', '高台': '52546', '天台': '58559',
               '阳信': '54723', '垣曲': '53968', '璧山': '57514', '寿宁': '58744', '平和': '59125', '肇东': '50858',
               '成县': '57102', '宽城': '54432', '江城': '56977', '府谷': '53567', '镇安': '57144', '贵南': '52955',
               '巴里坤': '52101', '瑞丽': '56838', '永州': '57866', '德惠': '54065', '海原': '53806', '新干': '58701',
               '正宁': '53935', '紫阳': '57231', '寻甸': '56781', '施甸': '56842', '石河子': '51356', '西宁': '52866',
               '盘州': 'R0824', '屯溪': '58531', '固镇': '58128', '大通': '52862', '武定': '56774', '嘉兴': '58452',
               '灵石': '53862', '启东': '58269', '黄石': '58407', '河口': '54732', '宁蒗': '56567', '三江': '57941',
               '富裕': '50742', '岑溪': '59454', '嘉善': '58451', '资溪': '58713', '平果': '59228', '大姚': '56761',
               '帕里': '55773', '二连浩特': '53068', '临沭': '58032', '农安': '54064', '昌邑': '54841', '涿州': '54502',
               '嫩江': '50557', '靖西': '59218', '同江': '50778', '霍邱': '58214', '孝昌': '57386', '仪征': '58242',
               '邵阳县': '57860', '余庆': '57729', '南陵': '58431', '铜仁': '57741', '九江': '58502', '阳原': '53492',
               '工布江达': '56301', '兴隆': '54425', '大柴旦': '52713', '喀左': '54328', '乌恰': '51705', '塔城': '51133',
               '仲巴': '55542', '陆丰': '59502', '梁河': '56840', '河曲': '53564', '海城': '54472', '桑日': '55599',
               '隆回': '57767', '徐家汇': '58367', '大连': '54662', '扬州': '58245', '右玉': '53478', '和顺': '53788',
               '娄烦': '53669', '冕宁': '56474', '鹿邑': '58101', '武功': '57034', '防城': '59631', '小二沟': '50548',
               '金平': '56987', '白山': '54371', '茫崖': '51886', '石家庄': '53698-sjz', '桂阳': '57973', '奉节': '57348',
               '镇江': '58248', '咸丰': '57540', '齐河': '54812', '南雄': '57996', '蓬莱': '54752', '冷水滩': '57865',
               '叙永': '57608', '峨边': '56387', '获嘉': '53988', '临潼': '57044', '闽侯': '58844', '镇宁': '57809',
               '大田': '58923', '太湖': '58414', '鹿寨': '59045', '成山头': '54776', '蕉岭': '59114', '内江': '57503',
               '武穴': '58501', '永平': '56746', '蓟州': '54428', '伊通': '54164', '云霄': '59322', '沈阳': '54342',
               '离石': '53764', '芦溪': '57794', '盈江': '56836', '习水': '57614', '聂荣': '55298', '乐业': '59012',
               '青阳': '58421', '得荣': '56441', '鸡西': '50978', '榆社': '53787', '刚察': '52754', '和平': '59099',
               '循化': '52972', '鹰潭': '58627', '阿图什': 'Y8996', '馆陶': '54809', '元谋': '56763', '安庆': '58424',
               '稻城': '56357', '辛集': '54701', '容城': '54503', '盂县': '53685', '七台河': '50971', '虎林': '50983',
               '献县': '54617', '杨凌': '57123', '兴安': '57955', '西乡': '57129', '鱼台': '54907', '喀什': 'Y9199',
               '师宗': '56883', '改则': '55248', '孪井滩': '53505', '常熟': '58352', '册亨': '57909', '武威': 'W2631',
               '莎车': '51811', '东营': '54736', '襄阳': '57278', '安国': '54604', '滑县': '53995', '铜鼓': '57694',
               '延津': '53997', '惠东': '59492', '永登': '52885', '淇县': '53974', '八里罕': '54316', '泸定': '56371',
               '嘉峪关': '52532', '沧源': '56944', '兰西': '50859', '吉安县': '57799', '蓝田': '57047', '英吉沙': '51802',
               '景洪': '56959',
               '广宁': '59271', '呼兰': '50956', '安福': '57798', '勐腊': '56969', '东兴': '59626', '荆州': '57476',
               '宁南': '56578', '淄川': '54824', '雷州': '59750', '政和': '58736', '玉屏': '57739', '理县': '56184',
               '孟州': '57072', '盐亭': '57308', '龙口': '54753', '公安': '57477', '平潭': '58944', '图们': '54293',
               '永春': '58934', '六枝': '57807', '费县': '54929', '汶川': '56183', '如东': '58264', '万盛': '57509',
               '资中': '56393', '南昌': '58606', '合川': '57512', '睢县': '58001', '武夷山': '58730', '闽清': '58839',
               '钟山': '59064', '靖宇': '54276', '兖州': '54916', '鹤庆': '56654', '锦屏': '57844', '赫山': '57674',
               '盐山': '54627', '北流': '59451', '剑阁': '57208', '常山': '58631', '廊坊': '54515', '铁干里克': '51765',
               '揭阳': '59315', '宝丰': '57181', '江孜': '55680', '阿拉山口': '51232', '平顶山': '57171', '东丰': '54261',
               '开鲁': '54134', '福泉': '57821', '高密': '54846', '韶关': '59082', '阳新': '58500', '且末': '51855',
               '互助': '52863', '贺兰': '53610', '岑巩': '57735', '普兰': '55437', '忠县': '57437', '呼图壁': '51367',
               '柯桥': '58453', '忻城': '59038', '怀来': '54405', '伊宁': '51431', '宜城': '57370', '宿州': '58122',
               '洛隆': '56223', '万荣': '53956', '若尔盖': '56079', '涡阳': '58114', '平山': '53694', '嵊州': '58556',
               '三门峡': '57051', '射洪': '57401', '博山': '54825', '易县': '54507', '湟源': '52855', '壶关': '53885',
               '永城': '58111', '浪卡子': '55681', '海口': '59758', '塔河': '50246', '宣恩': '57541', '徽县': '57110',
               '丹凤': '57153', '永年': '53895', '东至': '58419', '阜城': '54710', '许昌': '57089', '密云': '54416',
               '顺昌': '58823', '连云港': '58044', '绥中': '54454', '临沧': '56951', '岱山': '58484', '深州': '54608',
               '五台山': '53588', '鹿泉': '53698', '丰台': '54514', '义县': '54334', '海伦': '50756', '竹山': '57257',
               '威海': '54774', '巫山': '57349', '莆田': '58946', '胶州': '54849', '海门': '58360', '石楼': '53759',
               '邛崃': '56284', '通渭': '53908', '洞头': '58760', '曹县': '58002', '江达': '56136', '道县': '57965',
               '田林': '59017', '富源': '56790', '海丰': '59500', '崇武': '59133', '昭通': '56586', '张家界': '57558',
               '鄠邑': '57132', '南召': '57176', '梁平': '57426', '富宁': '59205', '丽江': '56651', '宣汉': '57326',
               '华容': '57575', '自贡': '56396', '炮台': '51352', '漳县': '56091', '安丘': '54844', '梅河口': '54266',
               '柳城': '59041', '滕州': '54927', '日喀则': '55578', '郧西': '57251', '鸡东': '50987', '楚雄': '56768',
               '龙泉驿': '56286', '武汉': '57494', '康定': '56374', '合肥': '58321', '黔江': '57536', '黄梅': '58409',
               '惠阳': '59298', '台山': '59478', '青岛': '54857', '巨鹿': '53799', '祁连': '52657', '威宁': '56691',
               '利辛': '58117', '井冈山': '57894', '熊岳': '54476', '凭祥': '59419', '华阴': '57055', '宜宾': 'S5702', '海兴': '54628',
               '保德': '53660', '礼泉': '57029', '文水': '53771', '武义': '58642', '周宁': '58747', '淅川': '57261', '邱县': '54820',
               '玉环': 'K8505', '常德': '57662', '肥城': '54819', '陵川': '53981', '额济纳旗': '52267', '英山': '58402',
               '衢江': 'K7504', '东阳': '58558', '临邑': '54712', '额敏': '51145', '宝清': '50888', '察隅': '56434', '都安': '59037',
               '将乐': '58821', '融水': '57948', '洛宁': '57066', '红安': '57398', '高碑店': '54506', '宾川': '56752', '龙山': '57544',
               '武宣': '59246', '乌当': '57915', '新林': '50349', '辉县': '53985', '天水': '57006', '凌源': '54327', '博罗': '59297',
               '蛟河': '54181', '西平': '57188', '明水': '50758', '濮阳': '54900', '光山': '57299', '平江': '57682', '黎平': '57839',
               '大理': '56751', '河间': '54614', '鄱阳': '58519', '玉树': '56029', '洮南': '50939', '郎溪': '58442', '通海': '56878',
               '临洮': '52986', '芜湖': '58334', '索县': '56106', '长子': '53873', '台江': '57834', '当雄': '55493', '巍山': '56757',
               '汤阴': '53991', '和静': '51559', '沙洋': '57484', '南阳': '57178', '海晏': '52853', '澄江': '56873', '闵行': '58361',
               '林芝': '56312', '攀枝花': '56666', '南宁城区': 'N1520', '千阳': '57021', '天峻': '52745', '柘城': '58007',
               '代县': '53579', '崂山': '54853', '上饶': '58637', '宜兴': '58346', '盐池': '53723', '那坡': '59209', '金阳': '56584',
               '阿巴嘎旗': '53192', '定边': '53725', '昌平': '54499', '英德': '59088', '新河': '54633', '禹城': '54811',
               '双湖': '55178', '沾化': '54730', '衡阳': '57872', '勃利': '50973', '周至': '57032', '安宁': '56863', '鲁山': '57173',
               '临川': '58619', '浦口': '58237', '太仆寺旗': '54305', '佛坪': '57134', '寻乌': '59102', '屯昌': '59854',
               '三明': '58828', '二道': '54285', '扶余': '54063', '汝南': '57197', '灵寿': '53680', '铅山': '58629', '巴中': '57313',
               '牟平': '54766', '大关': '56582', '宁洱': '56961', '门源': '52765', '泽当': '55598', '新龙': '56251', '清水河': '53562',
               '贞丰': '57905', '毕节': '57707', '加格达奇': '50442', '从江': '57936', '四平': '54157', '黄岩岛': '59989',
               '阿拉善右旗': '52576', '南溪': '56493', '潼关': '57054', '蔚县': '53593', '靖安': '58600', '尼木': '55585',
               '蒲县': '53864', '集贤': '50880', '泸州': 'S5031', '大新': '59421', '阳江': '59663', '南皮': '54719', '上蔡': '57194',
               '玛曲': '56074', '巴塘': '56247', '贡山': '56533', '开原': '54254', '招远': '54755', '渤海新区黄骅': '54624',
               '莲花': '57789', '贵德': '52868', '东乌珠穆沁旗': '50915', '法库': '54245', '广平': '53899', '临朐': '54835',
               '黔西': '57803', '肃宁': '54626', '道真': '57623', '马山': '59230', '平利': '57248', '定安': '59851', '攸县': '57779',
               '曲沃': '53961', '荣成': '54778', '大宁': '53856', '彰武': '54236', '滦州': '54531', '嘉禾': '57974', '茂名': '59659',
               '眉山': '56391', '庆城': '53829', '灵台': '53924', '滁州': '58236', '南川': 'A7003', '磁县': '53897', '泸溪': '57657',
               '斗门': '59487', '阿坝': '56171', '朱日和': '53276', '梁山': '54910', '巧家': '56673', '商水': '57198', '古县': '53874',
               '田东': '59224', '大悟': '57395', '通河': '50963', '淮阴': '58141', '海曙': 'K2158', '广丰区': '58635', '普定': '57808',
               '双柏': '56862', '应城': '57481', '宜章': '57976', '巨野': '54914', '盐都': '58154', '岳阳': '57584', '哈巴河': '51053',
               '沭阳': '58038', '盐源': '56565', '恭城': '59052', '米脂': '53750', '周村': '54829', '海宁': '58455',
               '察右中旗': '53378', '彭阳': '53913', '留坝': '57124', '中阳': '53767', '博兴': '54737', '新巴尔虎左旗': '50618',
               '内丘': '53797', '思南': '57731', '宁海': '58567', '伊克乌素': '53522', '元氏': '53791', '武冈': '57853',
               '平舆': '57292', '延长': '53854', '贵阳': '57816', '寿光': '54832', '抚宁': '54541', '昌宁': '56843', '呈贡': '56882',
               '电白': '59664', '武平': '58917', '余杭': 'K1418', '绵竹': '56186', '鄢陵': '57095', '肥西': '58320', '临猗': '53958',
               '吉隆': '55650', '南涧': '56851', '宜丰': '57696', '安定': '52995', '依兰': '50877', '灌云': '58047', '河南': '53732',
               '凤县': '57113', '仁布': '55587', '淳化': '57031', '晋宁': '56871', '塘沽': '54623', '荥阳': '57081', '北仑': '58563',
               '延平': '58834', '上栗': '57783', '个旧': '56984', '城固': '57128', '哈尔滨': '50953', '麦积': '57014', '高平': '53973',
               '延庆': '54406', '南郑': '57213', '凤城': '54494', '萨迦': '55670', '黑山': '54335', '弋阳': '58624', '丘北': '56889',
               '独山': '57922', '桃江': '57666', '婺源': '58529', '濉溪': '58113', '隰县': '53853', '临湘': '57585', '卫辉': '53994',
               '镇巴': '57238', '仪陇新政': 'S4241', '东平': '54911', '永顺': '57643', '峨眉山': '56385', '乌苏': '51346',
               '尖草坪': '53677', '北镇': '54331', '博爱': '53979', '波密': '56227', '福州': '58847', '防城港': '59635',
               '宁河': '54529', '固阳': '53357', '临桂': '57954', '巴林左旗': '54027', '嘉定': '58365', '清徐': '53774',
               '东胜': '53543', '广州': '59287', '宣化': '53498', '东兰': '59025', '曲松': '55693', '江川': '56876', '布尔津': '51060',
               '高安': '58605', '锡林浩特': '54102', '类乌齐': '56128', '班玛': '56151', '塔什库尔干': '51804', '当涂': '58335',
               '双鸭山': '50884', '徐水': '54601', '海拉尔': '50527', '苍南': 'K3248', '洱源': '56649', '灵璧': '58125',
               '理塘': '56257', '铜川': '53947', '黄岛': '54943', '汾西': '53865', '长海': '54579', '霍林郭勒': '50924',
               '赤壁': '57582', '岚皋': '57247', '青田': '58657', '靖远': '52895', '舍伯吐': '54039', '东安': '57867', '崇信': '53928',
               '土默特右旗': '53455', '三原': '57041', '靖江': '58257', '鄞州': '58562-AZJ', '满都拉': '53149', '灌南': '58048',
               '丹寨': '57829', '单县': '58011', '阿克苏': 'Y8677', '于都': '58905', '郴州': '57972', '全椒': '58230', '石阡': '57734',
               '文昌': '59856', '淮北': '58116', '五峰': '57458', '新田': '57971', '和林格尔县': '53469', '广饶': '54738',
               '南沙': '59997', '赤水': '57609', '乡宁': '53953', '通辽': '54135', '鄂托克旗': '53529', '南康': '57992',
               '沁阳': '53972', '丰镇': '53484', '昌乐': '54837', '湛江': '59658', '开封': '57091', '乌拉特前旗': '53433',
               '赫章': '56598', '万载': '57698', '应县': '53584', '拜泉': '50755', '临泽': '52557', '巴马': '59027', '丹阳': '58341',
               '即墨': '54855', '花都': '59284', '高州': '59653', '耒阳': '57876', '新乡': '53986', '丰城': '58609', '高雄': '59554',
               '高青': '54729', '宜都': '57465', '九华山': '58423', '潜山': '58415', '镇沅': '56867', '察布查尔': '51430',
               '青川': '57204', '荣县': '56394', '伊吾': '52118', '睢宁': '58130', '武邑': '54703', '邹城': '54919', '六合': '58235',
               '资兴': '57981', '西沙': '59981', '郧阳': '57253', '冠县': '54805', '祁东': '57870', '乐亭': '54539', '沾益': '56786',
               '芮城': '57053', '岢岚': '53662', '昭平': '59059', '龙州': '59417', '邯郸': '53892', '高陵': '57040', '富县': '53931',
               '庐山市': '58514', '聊城': '54806', '大城': '54613', '休宁': '58534', '永修': '58509', '阜平': '53690', '南江': '57216',
               '范县': '54903', '绥滨': '50787', '石景山': '54513', '连州': '59072', '乐安': '58706', '长岛': '54751',
               '德令哈': '52737', '庄浪': '53917', '左云': '53573', '伊金霍洛旗': '53545', '吉林城郊': '54172', '慈溪': '58467',
               '白城': '50936', '五营': '50772', '云梦': '57389', '托克托': '53467', '永昌': '52674', '库尔勒': 'Y8329',
               '小渠子': '51465', '普兰店': '54569', '赞皇': '53795', '博克图': '50632', '兴山': '57359', '克什克腾旗': '54117',
               '盱眙': '58138', '称多查拉沟': 'X7051', '嵩明': '56785', '关岭': '57903', '临武': '57978', '南漳': '57363',
               '蔡家湖': '51365', '黄山区': '58426', '裕民': '51137', '卢龙': '54438', '旬阳': '57242', '德化': '58935',
               '太仓': '58377', '广德': '58441', '申扎': '55472', '蒙自': '56985', '冀州': '54704', '江津': '57517', '云龙': '56742',
               '白云鄂博': '53343', '栾城': '53789', '赣县': '57993', '雷波': '56485', '碌曲': '56071', '商南': '57154',
               '平度': '54842', '弥勒': '56885', '恩平': '59477', '连江': '58848', '万年': '58615', '松原': '50946', '平邑': '54925',
               '墨玉': 'Y6286', '乐东': '59940', '融安': '57947', '播州': '57717', '南县': '57574', '鹤壁': '53990', '突泉': '50934',
               '炉霍': '56158', '新泰': '54922', '永宁': '53618', '瑞昌': '58503', '砚山': '56991', '兰陵': '58030', '崇州': '56181',
               '介休': '53863', '余干': '58612', '麦盖提': '51810', '邳州': '58026', '萍乡': '57786', '文登': '54777', '通山': '57595',
               '祁县': '53770', '远安': '57368', '康保': '53392', '炎陵': '57886', '霞浦': '58843', '泽普': '51815', '石门': '57562',
               '民和': '52876', '永安': '58921', '兴县': '53664', '陆川': '59457', '莱芜': '54828', '漠河': '50136', '巴楚': '51716',
               '沁水': '53970', '贡嘎': '55589', '德兴': '58622', '白玉': '56147', '福海': '51068', '西吉': '53903', '兴化': '58243',
               '久治': '56067', '克东': '50659', '江夏': '57493', '屏山': '56494', '鹤岗': '50775', '临江': '54374', '乌兰': '52833',
               '安义': '58602', '瓜州': '52424', '盐边': '56665', '连山': '59074', '尉犁': '51655', '徐闻': '59754', '南澳': '59324',
               '进贤': '58614', '赛罕': '53466-ANM', '鄂温克族自治旗': '50525', '禄劝': '56775', '安塞': '53841', '乌什': '51627',
               '屏南': '58933', '顺义': '54398', '达拉特旗': '53457', '贵港': '59249', '名山': '56280', '陇西': '56092',
               '大埔': '59116', '永善': '56489', '金坛区': '58342', '镇坪': '57343', '唐河': '57273', '科左后旗': '54231',
               '色达': '56152', '天池': '51470', '怀安': '53491', '博湖': '51663', '德钦': '56444', '海淀': '54399', '平安': '52875',
               '涟水': '58140', '彭山': '56289', '三河': '54520', '屯留': '53879', '平陆': '57061', '建平': '54326', '沧州': '54616',
               '行唐': '53688', '遵化': '54429', '札达': '55325', '弥渡': '56755', '望谟': '57906', '翼城': '53962', '梨树': '54154',
               '济南': '54823', '淮阳': '57192', '米东区': '51369', '钦州': '59632', '肥东': '58323', '徐州': '58027',
               '杜尔伯特': '50842', '五大连池': '50655', '湄潭': '57722', '眉县': '57027', '安化': '57669', '繁峙': '53585',
               '蓬溪': '57402', '济宁': '54915', '崇义': '57990', '纳雍': '57800', '湟中': '52869', '临汾': '53868', '和田': '51828',
               '涞源': '53599', '新郑': '57086', '唐山': '54534', '双江': '56950', '苏州': '58349', '洪洞': '53866',
               '四子王旗': '53362', '泰兴': '58249', '柳州': 'N2280', '前郭': '50949', '涪陵': '57522', '咸宁': '57590',
               '温县': '57079', '勐海': '56958', '宜阳': '57065', '北辰': '54528', '阿瓦提': '51722', '皋兰': '52884', '开州': '57338',
               '武隆': '57525', '南部': '57314', '温宿': '51629', '赤峰': '54218', '石岛': '54871', '磴口': '53419', '西峰': '53923',
               '东光': '54713', '姚安': '56764', '惠民': '54725', '寿阳': '53780', '黎川': '58719', '甘洛': '56473', '平谷': '54424',
               '遂平': '57189', '柘荣': '58749', '瓦房店': '54563', '五指山': '59941', '乳山': '54861', '石城': '58814',
               '湘潭': '57773', '阿勒泰': '51076', '剑河': '57835', '墨江': '56962', '汉阴': '57233', '化隆': '52877', '大庆': '50850',
               '唐县': '53692', '高淳': '58339', '余姚': '58468', '含山': '58330', '舞阳': '57185', '番禺': '59481', '湾沚': '58338',
               '安康': '57245', '柳河': '54267', '紫金': '59304', '龙圩': '59266', '广元': '57206', '饶平': '59313', '清原': '54259',
               '金沙': '57714', '恩施': '57447', '广宗': '54631', '旅顺': '54660', '龙南': '59092', '桐梓': '57606', '都昌': '58517',
               '卓尼': '56082', '丽水': '58646', '玉林': '59453', '通化': '54363', '当阳': '57460', '萨嘎': '55554', '会昌': '58906',
               '潞城': '53880', '上党': '53882', '神池': '53575', '大方': '57708', '罗山': '57298', '文县': '56192', '高邮': '58241',
               '北京': '54511', '石首': '57571', '两当': '57111', '郸城': '58100', '安阳': '53898', '绵阳': '56196', '宁县': '53937',
               '博乐': '51238', '六库': '56643', '永胜': '56652', '桂平': '59254', '围场': '54311', '安图': '54187', '南木林': '55572',
               '万宁': '59951', '仙桃': '57485', '宝鸡': '57016', '崇阳': '57586', '杭锦旗': '53533', '汝阳': '57078', '邵东': '57769',
               '托克逊': '51571', '华坪': '56664', '奈曼旗': '54223', '临河': '53513', '胡尔勒': '50832', '泾县': '58432',
               '中江': '56199', '灵山': '59446', '丰都': '57523', '凤冈': '57723', '漳浦': '59129', '德庆': '59269', '怀远': '58127',
               '土默特左旗': '53464', '兰溪': '58548', '修武': '53984', '晴隆': '57900', '天柱': '57840', '乌斯太': '52607',
               '富蕴': '51087', '永福': '57949', '五华': '59303', '五河': '58129', '松潘': '56182', '清涧': '53757', '鲁甸': '56585',
               '怀化': '57749', '仙居': '58652', '大安': '50945', '枣强': '54708', '偏关': '53565', '永川': '57506', '中牟': '57090',
               '会东': '56675', '希拉穆仁': '53367', '太原': '53679', '萝北': '50776', '柞水': '57140', '朗县': '56308',
               '甘南': '50741', '潮州': '59312', '平湖': '58464', '凤庆': '56846', '长乐': '58941', '偃师': '57076', '文山': '56994',
               '曲周': '53893', '鄄城': '54904', '谢通门': '55574', '建湖': '58146', '长葛': '57087', '布拖': '56580',
               '伊宁县': '51434', '章党': '54351', '巩义': '57080', '冷水江': '57760', '峄城': '58022', '兴文': '56496',
               '桃源': '57661', '印江': '57732', '广信': '58623', '水城': '56693', '林州': '53889', '蠡县': '54620', '广灵': '53590',
               '蒲江': '56281', '公主岭': '54156', '宁波': '58562', '吉首': '57649', '新和': '51636', '沙湾': '51357', '延川': '53850',
               '台前': '54817', '岗巴': '55677', '舟山': '58477', '阿拉善左旗': '53602', '新洲': '57492', '靖边': '53735',
               '靖州': '57841', '全州': '57960', '彬州': '57023', '玉山': '58634', '张家口': '54401', '乌鲁木齐牧试站': '51469',
               '砀山': '58015', '临海': '58660', '平坝': '57814', '乳源': '59081', '奉贤': '58463', '大英': '57403', '玛沁': '56043',
               '肃南': '52643', '菏泽': '54906', '安达': '50854', '古交': '53763', '洛浦': '51829', '海盐': '58458', '广安区': '57415',
               '长清': '54816', '辰溪': '57658', '芷江': '57745', '红河': '56975', '旌德': '58435', '确山': '57294', '大同': '53487',
               '石林': '56881', '龙泉': '58647', '乐山': '56386', '封开': '59264', '隆尧': '53794', '大邑': '56285', '郫都': '56272',
               '谷城': '57268', '三穗': '57832', '内黄': '53993', '瑞安': '58752', '库车': '51644', '石屏': '56970', '桐城': '58319',
               '太白': '57028', '德阳': 'S1933', '邕宁': '59435', '柴桑': '58505', '南浔': 'K5004', '吴忠': '53612', '霸州': '54518',
               '抚松': '54288', '梅县': '59117', '房县': '57259', '吉水': '58707', '景县': '54711', '秦安': '57002', '长安': '57039',
               '特克斯': '51438', '美姑': '56487', '揭西': '59306', '珲春': '54291', '甘德': '56045', '薛城': '58021', '灵武': '53619',
               '三水': '59279', '丰顺': '59310', '叙州': '56491', '潜江': '57475', '元江': '56966', '巴东': '57355', '扎兰屯': '50639',
               '本溪县': '54349', '宾阳': '59238', '化州': '59655', '孝感': '57482', '渭南': 'V3006', '普格': '56575',
               '额尔古纳': '50425', '阳高': '53486', '崇明': '58366', '扶绥': '59426', '天祝': 'W2553', '威远': '56395',
               '和县': '58331', '日土': '55125', '陇川': '56835', '五台': '53681', '灵川': '57956', '囊谦': '56125', '桓仁': '54365',
               '鹤山': '59473', '牡丹江': '54094', '舒兰': '54076', '金川': '56168', '香港天文台': '45005', '南城': '58715',
               '澧县': '57565', '深圳': '59493', '仁怀': '57710', '遵义': '57713', '临沂': '54938', '高唐': '54810', '青浦': '58461',
               '宁陕': '57137', '开阳': '57719', '桐柏': '57285', '泾川': '53926', '如皋': '58255', '长宁': '56593',
               '夷陵三峡': '57462', '儋州': '59845', '社旗': '57187', '监利': '57573', '宝国吐': '54226', '遂昌': '58644',
               '霍州': '53869', '泽库': '52968', '马关': '56995', '石嘴山': '53518', '科尔沁右翼中旗': '50937', '邹平': '54822',
               '洛阳': '57071', '通许': '57191', '安顺': 'R3117', '垦利': '54744', '吉县': '53859', '武城': '54709', '环江': '59031',
               '舒城': '58316', '和龙': '54286', '正阳': '57295', '钟祥': '57378', '磐石': '54263', '嘉鱼': '57583', '维西': '56548',
               '犍为': '56389', '涟源': '57762', '于田': '51931', '德江': '57637', '长白': '54386', '奉新': '58601', '彭水': '57537',
               '筠连': '56498', '索伦': '50834', '泌阳': '57281', '兴义': '57907', '革吉': '55234', '茂县': '56180', '威信': '56596',
               '灵丘': '53594', '云浮': '59471', '玛多': '56033', '沽源': '54301', '石渠': '56038', '翁牛特旗': '54213',
               '会宁': '52993', '汨罗': '57680', '永定': '59113', '金山': '58460', '承德县': '54430', '新建': '58693', '永德': '56849',
               '沈丘': '58104', '柏乡': '53785', '武胜': '57417', '达孜': '55595', '甘孜': '56146', '保亭': '59945', '滦平': '54420',
               '巴音布鲁克': '51542', '明光': '58223', '大厂': '54510', '宁武': '53577', '大佘太': '53348', '丹江口': '57260',
               '漯河': '57186', '汕头': '59316', '阜宁': '58143', '泗县': '58126', '东阿': '54815', '侯马': '53963', '尼玛': '55361',
               '龙井': '54290', '绿春': '56978', '紫云': '57910', '南宁': '59431', '诸城': '54848', '沙雅': '51639', '琼结': '55597',
               '科左中旗': '54047', '峨山': '56898', '上杭': '58918', '兴国': '58804', '察雅': '56235', '商州': '57143',
               '平阳': 'K3283', '柳林': '53753', '柳江': '59047', '合阳': '53950', '建阳': '58734', '清丰': '54902', '衡水': '54702',
               '资阳': '56298', '长丰': '58220', '隆子': '55696', '信阳': '57297', '崇礼': '54304', '十堰': '57256', '武鸣': '59237',
               '合作': '56080', '桓台': '54833', '衡山': '57777', '潢川': '58207', '赵县': '53784', '杭州': '58457',
               '乌鲁木齐': '51463', '永丰': '58705', '任泽': '53883', '昌图': '54243', '正定': '53691', '牙克石': '50526',
               '勉县': '57119', '房山': '54596', '遂川': '57896', '马尔康': '56172', '富民': '56772', '易门': '56870', '瑞金': '58903',
               '嘉荫': '50673', '微山': '58020', '蚌埠': '58221', '青龙': '54436', '乌海': '53512', '志丹': '53832', '阿拉尔': '51730',
               '新昌': '58555', '南海': '59288', '定南': '59093', '岗子': '54214', '中卫': '53704', '全南': '59091', '随县': '57371',
               '耀州': '57037', '麟游': '57022', '沙县': '58826', '荔浦': '59055', '扶沟': '57098', '雷山': '57837', '福安': '58748',
               '阜新': '54237', '明溪': '58824', '绥江': '56483', '阳山': 'G8419', '和布克赛尔': '51156', '三台': '57307',
               '淮滨': '58205', '郁南': '59268', '都江堰': '56188', '根河': '50431', '大兴': '54594', '深泽': '54621',
               '达坂城': '51477', '寿县': '58215', '苍溪': '57303', '藁城': '53697', '石柱': '57438', '保山': '56748', '宁德': '58846',
               '武清': '54523', '夏县': '57060', '云县': '56854', '凤台': '58212', '歙县': '58530', '麻栗坡': '56996',
               '辽阳县': '54345', '麻阳': '57743', '子洲': '53751', '太谷': '53775', '昌黎': '54540', '乐至': '57407',
               '莫力达瓦达斡尔族自治旗': '50645', '永清': '54519', '永寿': '57030', '林甸': '50749', '襄汾': '53861', '乐平': '58620',
               '呼中': '50247', '乌兰浩特': '50838', '涠洲岛': '59647', '古浪': '52784', '义乌': '58557', '双峰县': '57774',
               '天等': '59227', '三都': '57923', '民勤': '52681', '彝良': '56594', '罗定': '59462', '漾濞': '56745', '襄垣': '53884',
               '平顺': '53888', '仁化': '57989', '宜黄': '58714', '滨海': '58049', '六安': '58311', '贺州': '59065', '三清山': '58639',
               '那曲': '55299', '德安': '58508', '昔阳': '53783', '罗城': '59033', '渠县': '57413', '尼勒克': '51433', '密山': '50985',
               '峨眉': '56384', '五常': '54080', '沁源': '53875', '旬邑': '53938', '锦州': '54337', '共青城': '58604', '同安': '59130',
               '利津': '54731', '始兴': '59090', '永和': '53852', '交城': '53777', '黄岩': '58661', '津南': '54622', '万安': '57895',
               '博白': '59449', '横峰': '58625', '无锡': '58354', '共和': '52856', '祁门': '58520', '焦作': '53982',
               '莲都': '58646-AZJ', '佛冈': '59087', '岳池': '57414', '小金': '56178', '定襄': '53676', '栖霞': '54759',
               '珠海': '59488', '姜堰': '58250', '浦北': '59448', '新兴': '59470', '桂林': '57957', '临西': '54801', '华山': '57046',
               '嵊泗': '58472', '西畴': '56992', '沙河': '53781', '宜昌': 'Q4015', '拉孜': '55569', '古丈': '57646', '镇远': '57738',
               '承德': '54423', '汉川': '57486', '夏邑': '58017', '华宁': '56879', '漳平': '58926', '克拉玛依': '51243',
               '贵溪': '58626', '西华': '57193', '西峡': '57156', '陈仓': '57020', '滨州': '54734', '太和': '58109', '西林': '59004',
               '华安': '58928', '曲阜': '54918', '秀山': '57635', '绍兴': 'K4026', '武宁': '58507', '洛川': '53942', '多伦': '54208',
               '治多': '56016', '榆树': '54072', '封丘': '53983', '吴堡': '53756', '雄县': '54636', '平乐': '59053', '青冈': '50851',
               '通榆': '54041', '老河口': '57265', '莱西': '54851', '乌拉特中旗': '53336', '方山': '53760', '建始': '57445',
               '东方': '59838', '天门': '57483', '迁西': '54434', '海安': '58254', '河源': '59293', '衡阳县': '57871', '上高': '57699',
               '渝北': '57513', '巴林右旗': '54113', '原平': '53673', '白朗': '55579', '魏县': '53896', '鄂伦春自治旗': '50445',
               '巴南': '57518', '中山': '59485', '清河': '54706', '凤阳': '58222', '友谊': '50881', '平遥': '53778', '高阳': '54603',
               '景宁': '58648', '临县': '53659', '达日': '56046', '临漳': '53773', '长阳': '57464', '来安': '58234', '大竹': '57420',
               '夏河': '52978', '通化县': '54362', '汕尾': '59501', '吉兰泰': '53502', '安远': '58907', '安新': '54605',
               '林周': '55590', '团风': '57495', '辽源': '54260', '嘉祥': '54921', '黄冈': '57498', '永靖': '52980', '黑水': '56185',
               '富锦': '50788', '舟曲': '56094', '开化': '58537', '普宁': '59314', '九台': '54069', '潼南': '57409', '贵定': '57824',
               '乐陵': '54726', '舞钢': '57177', '秭归': '57358', '绥棱': '50767', '克山': '50658', '古蔺': '57605', '荣昌': '57505',
               '赣榆': '58040', '苍梧': 'N4094', '宣城': '58433', '新县': '57396', '顺德': '59480', '阜阳': '58203', '呼玛': '50353',
               '大石桥': '54475', '安乡': '57577', '讷河': '50646', '泊头': '54618', '容县': '59452', '涿鹿': '54408',
               '察右后旗': '53384', '汉寿': '57663', '日照': '54945', '江北': 'K2214', '甘谷': '57001', '长沙黄花': '57679',
               '固安': '54512', '措美': '55694', '宁阳': '54913', '玉溪': '56875', '巩留': '51435', '平远': '59106', '东山': '59321',
               '永嘉': '58658', '上犹': '57991', '滦南': '54437', '盐津': '56497', '茌平': '54814', '铜梁': '57510', '澄城': '53949',
               '禹州': '57088', '沙坪坝': '57516', '洪江': '57754', '白云': '57911', '保定': '54602', '环县': '53821', '宜春': '57793',
               '建德': '58544', '商城': '58301', '东莞': '59289', '洪泽': '58139', '黎城': '53878', '新宾': '54353', '思茅': '56964',
               '梧州': '59265', '桦南': '50879', '怀仁': '53580', '崇仁': '58710', '忻府': '53674', '曹妃甸零公里': '54538',
               '大洼': '54470', '泸西': '56886', '鄂州': '57496', '松溪': '58735', '佳县': '53658', '台北': '58968', '龙游': '58547',
               '山丹': '52661', '枝江': '57466', '略阳': '57106', '洪雅': '56380', '亳州': '58102', '颍上': '58210', '辉南': '54274',
               '清水': '57011', '南通': '58259', '射阳': '58150', '奇台': '51379', '泗洪': '58135', '吴桥': '54717', '宕昌': '56095',
               '安多': '55294', '上思': '59429', '大潭山': '45011', '五原': '53337', '商河': '54724', '临潭': '56081', '成都': 'S1003',
               '绥阳': '57720', '湖州': 'K5454', '会泽': '56684', '新晃': '57744', '饶阳': '54606', '厦门': '59134', '铜陵': '58429',
               '金昌': '52675', '乾县': '57035', '民权': '58004', '肃北': '52515', '镇康': '56839', '安溪': '58929', '营口': '54471',
               '叶县': '57184', '大荔': '57043', '新化': '57761', '沁县': '53872', '会同': '57842', '株洲': '57780', '宿迁': '58131',
               '新野': '57271', '阿城': '50958', '丰润': '54532', '华州': '57049', '东宁': '54099', '大名': '54804', '山阴': '53576',
               '汾阳': '53769', '福鼎': '58754', '庐山': '58506', '古田': '58836', '浚县': '53992', '桦甸': '54273', '岚县': '53665',
               '瓮安': '57728', '兴和': '53483', '安陆': '57388', '广南': '59007', '息烽': '57718', '新源': '51436', '简阳': '56295',
               '临澧': '57566', '邓州': '57274', '韶山': '57771', '高邑': '53790', '大丰': '58158', '宁陵': '58008', '邢台': '53798',
               '彭州': '56189', '林口': '50979', '城口': '57333', '琼海': '59855', '常州': '58343', '景东': '56856', '聂拉木': '55655',
               '富川': '59061', '邵武': '58725', '雅安': '56287', '登封': '57082', '神农架': '57362', '凤凰': '57740', '神木': '53651',
               '秦都': '57048', '晋江': '59137', '怀宁': '58416', '临泉': '58107', '依安': '50750', '阳朔': '59051', '塔中': '51747',
               '拉萨': '55591', '文成': '58750', '浦东': '58370', '格尔木': '52818', '荆门': '57377', '富顺': '56399', '嵩县': '57162',
               '盘山': '54338', '富阳': '58449', '彭泽': '58512', '长岭': '54049', '镶黄旗': '53289', '綦江': '57612', '项城': '57196',
               '永吉': '54171', '丹东': '54497', '静宁': '53906', '汉中': '57127', '长顺': '57818', '南和': '53891', '正安': '57625',
               '句容': '58344', '平武': '56193', '奉化': '58565', '中宁': '53705', '乐清': '58656', '绥芬河': '54096',
               '乌审召': '53547', '淮南': '58224', '昆明': '56778', '金乡': '54917', '德格': '56144', '衡南': '57875', '南岳': '57776',
               '爱辉': '50468', '琼中': '59849', '陕西横山': '53740', '北海': '59644', '巴彦诺日公': '52495', '三亚': 'M1068',
               '洛扎': '55686', '镇原': '53925', '运城': '53959', '望城区': 'P5600', '西丰': '54252', '孟连': '56949',
               '海力素': '53231', '南华': '56767', '景泰': '52797', '乐都': '52874', '汪清': '54195', '隆德': '53914', '望都': '54607',
               '蓝山': '57975', '都兰': '52836', '辽中': '54332', '九龙': '56462', '察哈尔右翼前旗': '53481', '伊春': '50774',
               '宁津': '54716', '边坝': '56211', '西昌': '56571', '金湖': '58147', '五莲': '54940', '资源': '57859', '五寨': '53663',
               '德清': 'K5079', '巢湖': '58326', '修水': '57598', '岳西': '58317', '凤翔': '57025', '新宁': '57851', '金华': '58549',
               '淄博': '54830', '孝义': '53768', '临安': '58448', '平泉': '54319', '绥宁': '57846', '巴仑台': '51467', '西盟': '56948',
               '庆安': '50861', '昭觉': '56479', '景德镇': '58527', '南宫': '54705', '罗江': '56198', '隆化': '54318', '汝城': '57985',
               '萝岗': '59287-lg', '宁化': '58818', '霍尔果斯': 'Y6460', '川汇区': '57195', '南安': '59131', '庐江': '58327',
               '凌海': '54330', '马鞍山': '58336', '新安': '57070', '温州': '58659', '曲水': '55586', '五通桥': '56388',
               '吴川': '59656', '桦川': '50878', '长沙市': '57687', '武乡': '53871', '仁和': '56674', '仁寿': '56297', '广汉': '56291',
               '巴雅尔吐胡硕': '50928', '敦化': '54186', '新丰': '59097', '河津': '53957', '化德': '53391', '平昌': '57324',
               '屏边': '56986', '施秉': '57737', '芦山': '56279', '宜良': '56880', '正蓝旗': '54205', '永新': '57891', '镇赉': '50940',
               '蒙阴': '54923', '拿山': '57883', '岷县': '56093', '敖汉旗': '54225', '万州': '57432', '石泉': '57232', '建水': '56973',
               '德保': '59215', '龙陵': '56841', '定远': '58225', '康乐': '52988', '榆中': '52983', '定日': '55664', '龙江': '50739',
               '精河': '51334', '务川': '57634', '怀柔': '54419', '都匀': '57827', '绥德': '53754', '左贡': '56331', '禄丰': '56777',
               '绩溪': '58438', '云和': '58742', '江永': '57969', '淮安区': '58145', '阿鲁科尔沁旗': '54122', '轮台': '51642',
               '怀集': '59270', '缙云': '58654', '定海': '58477-AZJ', '保靖': '57642', '乐昌': '57988', '方城': '57179',
               '泾源': '53916', '庄河': '54584', '阿尔山': '50727', '泰安': '54827', '海阳': '54863', '旺苍': '57217', '巴青': '56114',
               '青铜峡': '53617', '错那': '55690', '夹江': '56382', '信丰': '57995', '上林': '59235', '台州': '58665', '汶上': '54912',
               '陈巴尔虎旗': '50524', '浏阳': '57688', '泰州': '58246', '尚义': '53397', '泰顺': '58746', '罗田': '58401',
               '鞍山': '54339', '罗源': '58845', '天峨': '57927', '天长': '58240', '龙里': '57913', '双阳': '54165', '廉江': '59654',
               '商都': '53385', '桂东': '57889', '沂水': '54932', '武安': '53890', '凉城': '53475', '江宁': '58333', '银川': '53614',
               '达尔罕茂明安联合旗': '53352', '沛县': '58013', '堆龙德庆': '55594', '合浦': '59640', '泉州': '59132', '韩城': '53955',
               '安龙': '57908', '萧山': '58459', '竹溪': '57249', '随州': '57381', '北碚': '57511', '孟津': '57071-AHA',
               '扎囊': '55691', '稷山': '53954', '龙胜': '57942', '浮山': '53966', '响水': '58045', '包头': '53446', '同仁': '52974',
               '井研': '56390', '增城': '59294', '镇雄': '56595', '双辽': '54142', '新乐': '53695', '崇左': '59425', '长汀': '58911',
               '伊川': '57074', '泸县': '57508', '金溪': '58712', '顺平': '53596', '宜君': '53945', '济源': '53978', '凌云': '59015',
               '垫江': '57425', '青州': '54831', '准格尔旗': '53553', '普陀': '58570', '达川': '57328', '木兰': '50962',
               '清镇': '57813', '万山': '57742', '江安': '57600', '库伦旗': '54234', '庆云': '54728', '郯城': '58034', '临夏': '52984',
               '繁昌': '58337', '丁青': '56116', '浮梁': '58524', '静乐': '53666', '邵阳': '57766', '同心': '53810', '华池': '53930',
               '榆次': '53776', '苏尼特右旗': '53272', '金州': '54568', '威县': '54800', '北林': '50853', '狮泉河': '55228',
               '丹巴': '56263', '晋州': '53689', '连平': '59096', '辽阳': '54347', '宿松': '58417', '丰宁': '54308', '青龙山': '54132',
               '岫岩': '54486', '澄迈': '59843', '尚志': '50968', '泗阳': '58132', '九寨沟': '56097', '灯塔': '54348', '洪湖': '57581',
               '肥乡': '53980', '长兴': '58443', '修文': '57811', '宁城': '54320', '高力板': '54031', '柯坪': '51720', '措勤': '55357',
               '丰南': '54533', '北安': '50656', '灌阳': '57964', '松桃': '57647', '醴陵': '57781', '梓潼': '57304', '图里河': '50434',
               '天镇': '53490', '横州': '59441', '扬中': '58247', '和政': '52985', '澄海': '59319', '八宿': '56228',
               '吉木萨尔': '51378', '云阳': '57339', '广河': '52982', '青神': '56383', '景谷': '56952', '虞城': '58006',
               '北川': '56194', '安仁': '57881', '延寿': '50965', '武山': '57004', '济阳': '54821', '前锋': 'S4492', '焉耆': '51567',
               '丹棱': '56381', '宁乡': '57678', '利川': '57439', '象山': 'K2953', '东港': '54590', '蒙山': '59058', '衢州': '58633',
               '太康': '57099', '四会': '59276', '秦皇岛': '54449', '昭苏': '51437', '沿河': '57636', '双流': '56288', '大余': '57994',
               '永济': '57052', '定州': '53696', '台安': '54336', '余江': '58616', '兰州': '52889', '正镶白旗': '54204',
               '花溪': '57914', '无棣': '54722', '巫溪': '57345', '江口': '57736', '溆浦': '57752', '鄯善': '51581', '阜南': '58202',
               '阿合奇': '51711', '铁力': '50862', '甘泉': '53848', '加查': '56307', '米易': '56670', '南靖': '59124', '东台': '58251',
               '武陟': '53987', '东岗': '54284', '漳州': '59126', '商丘': '58005', '合江': '57603', '平南': '59255', '叶城': '51814',
               '枞阳': '58420', '无极': '53699', '遂溪': '59650', '百色': '59211', '夷陵': '57453', '宜州': '59034', '马边': '56480',
               '荔波': '57926', '清远': '59280', '三门': '58568', '连城': '58912', '曹妃甸': '54535', '木垒': '51482', '阜康': '51377',
               '乾安': '50948', '西乌珠穆沁旗': '54012', '南京': '58238', '张掖': 'W2085', '黟县': '58523', '衡东': '57778',
               '苏尼特左旗': '53195', '渝水': '57796', '孟村': '54644', '仙游': '58936', '耿马': '56946', '雅布赖': '52575',
               '井陉': '53693', '宁远': '57966', '松江': '58462', '嘉黎': '56202', '珙县': '56499', '西青': '54527', '扶风': '57026',
               '迭部': '56084', '富河': '54024', '庆元': '58745', '分宜': '57792', '海林': '54092', '镇海': '58561', '新会': '59476',
               '万源': '57237', '南丰': '58718', '莘县': '54808', '陆良': '56788', '康平': '54244', '汝州': '57075', '祥云': '56756',
               '渑池': '57063', '温泉': '51330', '曲靖': '56783', '白水': '53941', '新绛': '53964', '界首': '58108', '临淄': '54834',
               '渭源': '52998', '玉门': '52436', '黄山': '58437', '常宁': '57874', '宜川': '53857', '延安': '53845', '天全': '56278',
               '南充': '57411', '安泽': '53877', '兴海': '52943', '钱塘': 'K1213', '惠农': '53519', '湖口': '58510', '潍坊': '54843',
               '连山区': '54453', '左权': '53786', '长武': '53929', '昌江': '59847', '临清': '54802', '无为': '58329', '象州': '59241',
               '翁源': '59094', '墨脱': '56319', '金塔': '52447', '吴起': '53738', '通城': '57589', '青县': '54615', '陵城': '54715',
               '饶河': '50892', '松阳': '58645', '乌审旗': '53644', '杭锦后旗': '53420', '西充': '57309', '木里': '56459',
               '尉氏': '57094', '万全': '53499', '托里': '51241', '溧阳': '58345', '襄城': '57182', '固原': '53817', '光泽': '58724',
               '故城': '54707', '清流': '58819', '纳溪': '57604', '遂宁': '57405', '拐子湖': '52378', '黄龙': '53946', '平罗': '53611',
               '湘乡': '57772', '田阳': '59213', '山阳': '57155', '路桥': 'K8301', '合水': '53934', '新津': '56276', '榕江': '57932',
               '成安': '53996', '内乡': '57169', '杞县': '57096', '绛县': '53965', '隆林': '59001', '安吉': '58446', '道孚': '56167',
               '交口': '53860', '泗水': '54920', '新蔡': '57293', '黑牛城': '54517', '南昌县': '58607', '开江': '57329',
               '阳泉': '53782', '岳普湖': '51717', '莱阳': '54852', '陶乐': '53615', '蒲城': '53948', '巴彦': '50867', '枣庄': '58024',
               '临高': '59842', '会理城区': 'S0554', '乌拉盖': '50913', '湘阴': '57673', '诏安': '59320', '郏县': '57180',
               '镇平': '57175', '普安': '56792', '长寿': '57520', '鹤峰': '57543', '保康': '57361', '昂仁': '55568',
               '鄂托克前旗': '53730', '开平': '59475', '什邡': '56197', '新邵': '57768', '新都': '56290', '和硕': '51568',
               '白河': '57254', '宽甸': '54493', '阆中': '57306', '康巴什体育中心': 'C8543', '永仁': '56669', '东丽': '54526',
               '安平': '54609', '凯里': '57825', '上虞': '58553', '黄陵': '53944', '青河': '51186', '岐山': '57024', '藤县': '59256',
               '雅江': '56267', '兴城': '54455', '平原': '54718', '皮山': '51818', '阿荣旗': '50647', '泰来': '50844', '白银': '52896',
               '桐乡': '58456', '龙港': 'K3269', '策勒': '51826', '阳春': '59469', '浦城': '58731', '鸡泽': '54640', '元阳': '56976',
               '汉源': '56376', '朔州': '53578', '孙吴': '50564', '花垣': '57640', '京山': '57387', '江华': '59063',
               '呼和浩特': '53466', '大冶': '57499', '长垣': '53998', '乡城': '56443', '樟树': '58608', '贡觉': '56233',
               '宁国': '58436', '崆峒': '53915', '张北': '53399', '逊克': '50566', '茶陵': '57882', '佳木斯': '50873', '满城': '54611',
               '台中': '59158', '比如': '56109', '泰和': '57899', '卓资': '53472', '信宜': '59456', '丰县': '58012', '莒县': '54936',
               '吉木乃': '51059', '汤旺': '50674', '黄陂': '57491', '泾阳': '57033', '黄平': '57822', '开远': '56982', '阳城': '53975',
               '宝兴': 'S6409', '礼县': '57007', '织金': '57805', '武都': '56096', '酒泉': '52533', '班戈': '55279', '壤塘': '56164',
               '莒南': '54939', '富平': '57042', '罗甸': '57916', '慈利': '57564', '温江': '56187', '若羌': '51777', '永康': '58643',
               '隆安': '59229', '惠水': '57912', '阿克陶': '51708', '平塘': '57921', '溧水': '58340', '宝坻': '54525', '洞口': '57758',
               '新密': '57085', '湘江新区': 'P5599', '宝山': '58362', '安岳': '57408', '哈密': '52203', '浦江': '58546',
               '莫索湾': '51353', '昌吉': 'Y5522', '福贡': '56641', '霍山': '58314', '惠来': '59317', '从化': '59285', '兰考': '57093',
               '肇州': '50950', '双牌': '57962', '新沂': '58035', '宣威': '56697', '拜城': '51633', '临城': '53792', '卢氏': '57067',
               '郑州': '57083', '龙岩': '58927', '牟定': '56766', '广水': '57385', '张家川': '57012', '香河': '54521',
               '扎赉特旗': '50833', '淳安': '58543', '江都': '58244', '临颍': '57183', '来凤': '57545', '澜沧': '56954',
               '尖扎': '52963', '新平': '56869', '集宁': '53480', '兴平': '57038', '宝应': '58148', '南丹': '59022', '玉田': '54522',
               '罗平': '56891', '抚远': '50779', '德昌': '56569', '永泰': '58932', '桑植': '57554', '云州': '53488', '静海': '54619',
               '本溪': '54346', '小店': '53679-ASX', '临平': '58444', '吴江': '58359', '陵水': '59954', '江阴': '58351',
               '兰坪': '56645', '福山': '54764', '宁安': '54098', '阳曲': '53678', '大足': '57502', '酉阳': '57633', '满洲里': '50514',
               '喜德': '56478', '郓城': '54905', '墨竹工卡': '55593', '邻水': '57416', '萧县': '58016', '枣阳': '57279',
               '杂多': '56018', '华亭': '53927', '平阴': '54818', '芒康': '56342', '门头沟': '54505', '迁安': '54439', '宁强': '57211',
               '峰峰': '53894',
               '集安': '54377', '松滋': '57469', '平定': '53687', '安州': '56190', '武强': '54700', '阳谷': '54807', '闻喜': '53967',
               '高县': '56592', '定陶': '54909', '越西': '56475', '芒市': '56844', '长春': '54161', '西安': 'V8870', '西和': '57008',
               '建瓯': '58737', '河池': '59023', '江山': '58632', '潮阳': '59318', '隆昌': '57507', '张家港': '58353',
               '太华山': '56872', '昆山': '58356', '子长': '53748', '东海': '58036', '龙门': '59290', '尤溪': '58837', '东明': '54908',
               '德州': '54714', '章丘': '54727', '香格里拉': '56543', '穆棱': '54093', '铁岭': '54249', '霍城': '51329',
               '灵宝': '57056', '祁阳': '57868', '曲阳': '53682'}

    if city_name in city_id:
        return city_id[city_name]
    else:
        return f"城市 {city_name} 不存在，请重新尝试！"

def read_now(city):
    id=get_city_id2(str(city))
    url = f'https://weather.cma.cn/api/now/{id}'
    response = requests.get(url)
    data = response.json()

    if data['code'] == 0:
        name = data['data']['location']['path']
        precipitation = data['data']['now']['precipitation']
        temperature = data['data']['now']['temperature']
        pressure = data['data']['now']['pressure']
        humidity = data['data']['now']['humidity']
        windDirection = data['data']['now']['windDirection']
        windDirectionDegree = data['data']['now']['windDirectionDegree']
        windSpeed = data['data']['now']['windSpeed']
        windScale = data['data']['now']['windScale']
        lastUpdate = data['data']['lastUpdate']

        weather_info = {
            "Path": name,
            "Temperature": temperature,
            "Precipitation": precipitation,
            "Pressure": pressure,
            "Humidity": humidity,
            "Wind Direction": windDirection,
            "Wind Direction Degree": windDirectionDegree,
            "Wind Speed": windSpeed,
            "Wind Scale": windScale,
            "Last Update": lastUpdate
        }

        return weather_info
    else:
        return "数据获取失败"


def read_past(lat, long, start_date, end_date):
    # 查找附近的气象站
    stations = Stations()
    stations = stations.region('CN')  # 'CN' 是中国的 ISO 3166 国家代码
    stations = stations.nearby(lat, long)  # 指定坐标
    station_list = stations.fetch(1)
    # 选择第一个气象站的 ID
    station_id = station_list.index[0]

    # 下载该气象站的每小时数据
    start_date = pd.to_datetime(str(start_date), format='%Y%m%d%H%M')
    end_date = pd.to_datetime(str(end_date), format='%Y%m%d%H%M')

    data = Hourly(station_id, start_date, end_date)
    data = data.fetch()

    # 重命名列名
    rename_dict = {
        'temp': '气温(℃)',
        'dwpt': '露点温度(℃)',
        'rhum': '相对湿度(%)',
        'prcp': '降水量(mm)',
        'snow': '积雪深度(cm)',
        'wdir': '风向(度数，0-360)',
        'wspd': '平均风速(km/h)',
        'wpgt': '最大风速(km/h)',
        'pres': '气压(hpa)'
    }
    data = data.rename(columns=rename_dict)

    # 删除tsun和coco列（如果存在）
    data = data.drop(columns=['tsun', 'coco'], errors='ignore')

    # 添加时间列
    data['时间'] = data.index.strftime('%Y-%m-%d %H:%M:%S')

    stationname = get_city_name(station_id)

    return data, stationname


def get_city_id(city_name):
    city_data = pd.read_excel(r'city_id.xlsx')
    city_id = city_data.loc[city_data['ReadmeName'] == city_name, 'CityCode'].values
    if len(city_id) > 0:
        return city_id[0]
    else:
        return None
def get_city_name(city_id):
    # 读取城市数据文件
    city_data = pd.read_excel(r'F:\TC\气象虚拟实习_kxy\环境污染_project\weishala\city_id.xlsx')
    # 在城市数据中查找指定城市代码对应的城市名称
    city_name = city_data.loc[city_data['CityCode'] == city_id, 'ReadmeName'].values
    # 如果找到了对应的城市名称，就返回该名称；否则返回None
    if len(city_name) > 0:
        return city_name[0]
    else:
        return None

def read_forecast(url, num=7):
    def getHTMLText(url, timeout=30):
        try:
            r = requests.get(url, timeout=timeout)
            r.raise_for_status()
            r.encoding = r.apparent_encoding
            return r.text
        except:
            return '产生异常'

    def get_city_name(soup):
        try:
            city_name = soup.find('div', class_='ctop').find('h1').string
        except AttributeError:
            try:
                city_name = soup.find('div', class_='crumbs fl').find('a').string
            except AttributeError:
                city_name = 'Unknown City'
        return city_name

    def get_data(html):
        wind_directions = ['北风', '东北风', '东风', '东南风', '南风', '西南风', '西风', '西北风', '旋转风']
        final_list = []
        soup = BeautifulSoup(html, 'html.parser')
        body = soup.body
        data = body.find('div', {'id': '7d'})
        ul = data.find('ul')
        lis = ul.find_all('li')

        for day in lis[:num]:
            temp_list = []
            date = day.find('h1').string
            temp_list.append(date)
            info = day.find_all('p')
            temp_list.append(info[0].string)

            if info[1].find('span') is None:
                temperature_highest = ' '
            else:
                temperature_highest = info[1].find('span').string
                temperature_highest = temperature_highest.replace('℃', ' ')

            if info[1].find('i') is None:
                temperature_lowest = ' '
            else:
                temperature_lowest = info[1].find('i').string
                temperature_lowest = temperature_lowest.replace('℃', ' ')

            temp_list.append(temperature_highest)
            temp_list.append(temperature_lowest)

            wind_scale = info[2].find('i').string
            temp_list.append(wind_scale)

            wind_direction = random.choice(wind_directions)
            temp_list.append(wind_direction)

            final_list.append(temp_list)

        return final_list, get_city_name(soup)

    city_id = get_city_id(url.split('/')[-1].split('.')[0])  # Get city ID from URL
    if city_id is None:
        return '城市名字错误'

    full_url = f'http://www.weather.com.cn/weather/{city_id}.shtml'
    html = getHTMLText(full_url)
    final_list, city_name = get_data(html)

    df = pd.DataFrame(final_list, columns=['日期', '天气', '最高温度', '最低温度', '风级', '风向'])

    return df


def get_image(time_str):
    try:
        url = f'https://pi.weather.com.cn/i/product/pic/m/sevp_nsmc_wxbl_fy4b_etcc_achn_lno_py_{time_str}00000.jpg'
        encoded_url = urllib.parse.quote(url, safe=':/')
        response = urllib.request.urlopen(encoded_url)
        image_data = response.read()
        image = Image.open(BytesIO(image_data))
        image_path = f'FY4B True Color Image_{time_str}.jpg'
        image.save(image_path, dpi=(1080, 1080))
        return True
    except urllib.error.HTTPError as e:
        if e.code == 404:
            return False
        else:
            raise
    except Exception as e:
        raise


def readfigtempture(df):
    plt.figure(figsize=(10, 6))
    plt.plot(df['日期'], df['最高温度'], 'r-', label='最高温度')
    plt.plot(df['日期'], df['最低温度'], 'b-', label='最低温度')
    plt.xlabel('日期')
    plt.ylabel('温度')
    plt.title('Forecast_Temperature')
    plt.legend(loc='upper right')
    plt.show()
    return plt

def create_rgb_image(path):
    # 打开 HDF 文件
    data = h5py.File(path, "r")

    # 读取红、绿、蓝三个通道的数据
    red_channel = data['NOMChannel01'][:]
    green_channel = data['NOMChannel02'][:]
    blue_channel = data['NOMChannel03'][:]

    # 标定超过3000的值为0
    red_channel[red_channel > 3000] = 0
    green_channel[green_channel > 3000] = 0
    blue_channel[blue_channel > 3000] = 0

    # 创建一个RGB图像数组
    rgb_image = np.stack([red_channel, green_channel, blue_channel], axis=-1)

    # 归一化到0-1范围
    rgb_image = (rgb_image - rgb_image.min()) / (rgb_image.max() - rgb_image.min())

    # 绘制RGB彩色增强图像
    fig, ax = plt.subplots()
    cax = ax.imshow(rgb_image)
    ax.set_title('True Color Composite (0.47um, 0.65um, 0.83um)')
    ax.set_xlabel('X Axis')
    ax.set_ylabel('Y Axis')
    ax.axis('off')  # 关闭坐标轴显示

    # 获取当前时间并格式化为指定字符串格式
    current_time = datetime.now().strftime("%Y%m%d%H%M")

    # 保存图像到当前脚本目录下，文件名为 time+当前时间（年月日小时分钟）
    save_path = f"time{current_time}.png"
    plt.savefig(save_path, dpi=1080, facecolor='white', bbox_inches='tight')


def create_TD_image(path,TD):
    # 打开 HDF 文件
    data = h5py.File(path, "r")

    channel = data[TD][:]
    channel[channel > 3000] = 0

    fig, ax = plt.subplots()
    cax = ax.imshow(channel)
    ax.set_title(TD+'monochrome')
    ax.set_xlabel('X Axis')
    ax.set_ylabel('Y Axis')
    ax.axis('off')  # 关闭坐标轴显示

    # 获取当前时间并格式化为指定字符串格式
    current_time = datetime.now().strftime("%Y%m%d%H%M")

    # 保存图像到当前脚本目录下，文件名为 time+当前时间（年月日小时分钟）
    save_path = f"time{current_time}.png"
    plt.savefig(save_path, dpi=1080, facecolor='white', bbox_inches='tight')

def create_TD_image(path, TD):
    # 打开 HDF 文件
    data = h5py.File(path, "r")
    channel = data[TD][:]
    channel[channel > 3000] = 0

    # 绘制黑白图像
    fig, ax = plt.subplots()
    cax = ax.imshow(channel, cmap='gray')  # 使用灰度色彩映射
    ax.set_title(TD + ' monochrome')
    ax.set_xlabel('X Axis')
    ax.set_ylabel('Y Axis')
    ax.axis('off')  # 关闭坐标轴显示

    # 获取当前时间并格式化为指定字符串格式
    current_time = datetime.now().strftime("%Y%m%d%H%M")

    # 保存图像到当前脚本目录下，文件名为 time+当前时间（年月日小时分钟）
    save_path = f"time{current_time}.png"
    plt.savefig(save_path, dpi=1080, facecolor='white', bbox_inches='tight')
    plt.close()  # 关闭图像防止内存泄漏

def create_BW_image(path, TD):
    # 打开 HDF 文件
    data = h5py.File(path, "r")

    # 黑白增强通道1
    channel_data = data[TD][:]
    channel_data[channel_data > 3000] = 0  # 将超过3000的值标定为0

    # 黑白增强处理
    enhanced_data = (channel_data - np.min(channel_data)) / (np.max(channel_data) - np.min(channel_data))

    # 绘制黑白图像
    fig, ax = plt.subplots()
    cax = ax.imshow(enhanced_data, cmap='gray')  # 使用灰度色彩映射
    ax.set_title(TD + ' monochrome enhancement')
    ax.set_xlabel('X Axis')
    ax.set_ylabel('Y Axis')
    ax.axis('off')  # 关闭坐标轴显示

    # 获取当前时间并格式化为指定字符串格式
    current_time = datetime.now().strftime("%Y%m%d%H%M")

    # 保存图像到当前脚本目录下，文件名为 time+当前时间（年月日小时分钟）
    save_path = f"time{current_time}.png"
    plt.savefig(save_path, dpi=1080, facecolor='white', bbox_inches='tight')
    plt.close()  # 关闭图像防止内存泄漏